import{c as n}from"./app.e1cbe8dc.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";const a={},e=n(`<h1 id="mongodb" tabindex="-1"><a class="header-anchor" href="#mongodb" aria-hidden="true">#</a> MongoDB</h1><table><thead><tr><th>SQL\u672F\u8BED/\u6982\u5FF5</th><th>MongoDB\u672F\u8BED/\u6982\u5FF5</th><th>\u89E3\u91CA/\u8BF4\u660E</th></tr></thead><tbody><tr><td>database</td><td>database</td><td>\u6570\u636E\u5E93</td></tr><tr><td>table</td><td>collection</td><td>\u6570\u636E\u5E93\u8868/\u96C6\u5408</td></tr><tr><td>row</td><td>document</td><td>\u6570\u636E\u8BB0\u5F55\u884C/\u6587\u6863</td></tr><tr><td>column</td><td>field</td><td>\u6570\u636E\u5B57\u6BB5/\u57DF</td></tr><tr><td>index</td><td>index</td><td>\u7D22\u5F15</td></tr><tr><td>table joins</td><td>\u8868\u8FDE\u63A5,MongoDB\u4E0D\u652F\u6301</td><td></td></tr><tr><td>\u5D4C\u5165\u6587\u6863</td><td>MongoDB\u901A\u8FC7\u5D4C\u5165\u5F0F\u6587\u6863\u6765\u66FF\u4EE3\u591A\u8868\u8FDE\u63A5</td><td></td></tr><tr><td>primary key</td><td>primary key</td><td>\u4E3B\u952E,MongoDB\u81EA\u52A8\u5C06_id\u5B57\u6BB5\u8BBE\u7F6E\u4E3A\u4E3B\u952E</td></tr></tbody></table><h2 id="\u4E00\u3001\u5E38\u7528\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u4E00\u3001\u5E38\u7528\u547D\u4EE4" aria-hidden="true">#</a> \u4E00\u3001\u5E38\u7528\u547D\u4EE4</h2><blockquote><p>mongoDB\u50A8\u5B58\u5206\u4E3A\u4E24\u4E2A\u90E8\u5206\uFF0C\u4E0A\u90E8\u5206\u4E3A\u5185\u5B58\uFF0C\u4E0B\u90E8\u5206\u4E3A\u78C1\u76D8\uFF0C\u5F53\u4F7F\u7528use\u521B\u5EFA\u7684\u65F6\u5019\uFF0C\u5B58\u653E\u7684\u662F\u5185\u5B58\u8FD8\u6CA1\u6709\u6301\u4E45\u5316\u7684\u50A8\u5B58\u5230\u78C1\u76D8\u7684\u4F4D\u7F6E(\u76F4\u5230\u8BE5database\u91CC\u9762\u6709\u96C6\u5408/\u6570\u636E\u7684\u65F6\u5019\u624D\u4F1A\u88AB\u50A8\u5B58\u5230\u78C1\u76D8\u4E2D)\uFF0C\u800Cshow\u51FA\u6765\u7684\u662F\u78C1\u76D8\u7684\u4F4D\u7F6E\uFF0C\u6240\u4EE5use\u521B\u5EFA\u540E\u76F4\u63A5show\u662F\u65E0\u6CD5\u76F4\u63A5\u770B\u5230\u521A\u521A\u521B\u5EFA\u7684database</p></blockquote><blockquote><ul><li>\u6570\u636E\u5E93\u521B\u5EFA\u7684\u89C4\u8303 <ul><li>\u4E0D\u80FD\u662F\u7A7A\u5B57\u7B26\u4E32\uFF08&quot;&quot;)\u3002</li><li>\u4E0D\u5F97\u542B\u6709&#39; &#39;\uFF08\u7A7A\u683C)\u3001.\u3001$\u3001/\u3001\\\u548C\\0 (\u7A7A\u5B57\u7B26)\u3002</li><li>\u5E94\u5168\u90E8\u5C0F\u5199\u3002</li><li>\u6700\u591A64\u5B57\u8282\u3002</li><li>admin\uFF1A \u4ECE\u6743\u9650\u7684\u89D2\u5EA6\u6765\u770B\uFF0C\u8FD9\u662F&quot;root&quot;\u6570\u636E\u5E93\u3002\u8981\u662F\u5C06\u4E00\u4E2A\u7528\u6237\u6DFB\u52A0\u5230\u8FD9\u4E2A\u6570\u636E\u5E93\uFF0C\u8FD9\u4E2A\u7528\u6237\u81EA\u52A8\u7EE7\u627F\u6240\u6709\u6570\u636E\u5E93\u7684\u6743\u9650\u3002\u4E00\u4E9B\u7279 \u5B9A\u7684\u670D\u52A1\u5668\u7AEF\u547D\u4EE4\u4E5F\u53EA\u80FD\u4ECE\u8FD9\u4E2A\u6570\u636E\u5E93\u8FD0\u884C\uFF0C\u6BD4\u5982\u5217\u51FA\u6240\u6709\u7684\u6570\u636E\u5E93\u6216\u8005\u5173\u95ED\u670D\u52A1\u5668\u3002</li><li>local: \u8FD9\u4E2A\u6570\u636E\u6C38\u8FDC\u4E0D\u4F1A\u88AB\u590D\u5236\uFF0C\u53EF\u4EE5\u7528\u6765\u5B58\u50A8\u9650\u4E8E\u672C\u5730\u5355\u53F0\u670D\u52A1\u5668\u7684\u4EFB\u610F\u96C6\u5408</li><li>config: \u5F53Mongo\u7528\u4E8E\u5206\u7247\u8BBE\u7F6E\u65F6\uFF0Cconfig\u6570\u636E\u5E93\u5728\u5185\u90E8\u4F7F\u7528\uFF0C\u7528\u4E8E\u4FDD\u5B58\u5206\u7247\u7684\u76F8\u5173\u4FE1\u606F\u3002</li></ul></li></ul></blockquote><ul><li><strong>\u6570\u636E\u5E93\u64CD\u4F5C</strong><ul><li><code>mongo --host XX --port XX</code>\uFF1A\u542F\u52A8</li><li><code>use \u6570\u636E\u5E93\u540D\u79F0</code>\uFF1A\u9009\u62E9\u548C\u521B\u5EFA\u6570\u636E\u5E93</li><li><code>show dbs</code>\uFF1A\u67E5\u770B\u73B0\u6709\u5E93</li><li><code>db</code>\uFF1A\u67E5\u770B\u5F53\u524D\u6B63\u5728\u4F7F\u7528\u7684\u6570\u636E\u5E93</li><li><code>db.dropDatabase()</code>\uFF1A\u5220\u9664\u5E93\uFF0C\u9700\u5148\u8FDB\u5165\u8BE5\u5E93</li></ul></li></ul><blockquote><ul><li>\u96C6\u5408\u521B\u5EFA\u7684\u89C4\u8303 <ul><li>\u96C6\u5408\u540D\u4E0D\u80FD\u662F\u7A7A\u5B57\u7B26\u4E32&quot;&quot;\u3002</li><li>\u96C6\u5408\u540D\u4E0D\u80FD\u542B\u6709\\0\u5B57\u7B26\uFF08\u7A7A\u5B57\u7B26)\uFF0C\u8FD9\u4E2A\u5B57\u7B26\u8868\u793A\u96C6\u5408\u540D\u7684\u7ED3\u5C3E\u3002</li><li>\u96C6\u5408\u540D\u4E0D\u80FD\u4EE5&quot;system.&quot;\u5F00\u5934\uFF0C\u8FD9\u662F\u4E3A\u7CFB\u7EDF\u96C6\u5408\u4FDD\u7559\u7684\u524D\u7F00\u3002</li><li>\u7528\u6237\u521B\u5EFA\u7684\u96C6\u5408\u540D\u5B57\u4E0D\u80FD\u542B\u6709\u4FDD\u7559\u5B57\u7B26\u3002\u6709\u4E9B\u9A71\u52A8\u7A0B\u5E8F\u7684\u786E\u652F\u6301\u5728\u96C6\u5408\u540D\u91CC\u9762\u5305\u542B\uFF0C\u8FD9\u662F\u56E0\u4E3A\u67D0\u4E9B\u7CFB\u7EDF\u751F\u6210\u7684\u96C6\u5408\u4E2D\u5305\u542B\u8BE5\u5B57\u7B26\u3002\u9664\u975E\u4F60\u8981\u8BBF\u95EE\u8FD9\u79CD\u7CFB\u7EDF\u521B\u5EFA\u7684\u96C6\u5408\uFF0C\u5426\u5219\u5343\u4E07\u4E0D\u8981\u5728\u540D\u5B57\u91CC\u51FA\u73B0$\u3002</li></ul></li></ul></blockquote><ul><li><strong>\u96C6\u5408\u64CD\u4F5C\uFF08\u8868\uFF09</strong><ul><li><code>show tables</code>\uFF1A\u67E5\u770B\u73B0\u6709\u96C6\u5408</li><li>\u663E\u5F0F\u521B\u5EFA\uFF1A <ul><li><code>db.createCollection(\u8868\u540D)</code>\uFF1A\u521B\u5EFA\u96C6\u5408</li><li><code>db.\u96C6\u5408\u540D.drop()</code>\uFF1A\u5220\u9664\u96C6\u5408</li></ul></li><li>\u9690\u5F0F\u521B\u5EFA\u7684\u610F\u601D\u662F\u521B\u5EFA\u6587\u6863\u7684\u65F6\u5019\uFF0C\u5982\u679C\u96C6\u5408\u4E0D\u5B58\u5728\u5C31\u81EA\u52A8\u521B\u5EFA\u96C6\u5408\u3002</li></ul></li></ul><blockquote><ul><li>comment\u96C6\u5408\u5982\u679C\u4E0D\u5B58\u5728\uFF0C\u5219\u4F1A\u9690\u5F0F\u521B\u5EFA</li><li>mongo\u4E2D\u7684\u6570\u5B57\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u662Fdouble\u7C7B\u578B\uFF0C\u5982\u679C\u8981\u5B58\u6574\u578B\uFF0C\u5FC5\u987B\u4F7F\u7528\u51FD\u6570NumberInt(\u6574\u578B\u6570\u5B57)\uFF0C\u5426\u5219\u53D6\u51FA\u6765\u5C31\u6709\u95EE\u9898\u4E86\u3002</li><li>\u63D2\u5165\u5F53\u524D\u65E5\u671F\u4F7F\u7528 new Date()</li><li>\u63D2\u5165\u7684\u6570\u636E\u6CA1\u6709\u6307\u5B9A<code>_id</code>\uFF0C\u4F1A\u81EA\u52A8\u751F\u6210\u4E3B\u952E\u503C</li><li>\u5982\u679C\u67D0\u5B57\u6BB5\u6CA1\u503C\uFF0C\u53EF\u4EE5\u8D4B\u503C\u4E3Anull\uFF0C\u6216\u4E0D\u5199\u8BE5\u5B57\u6BB5\u3002</li><li>\u89C4\u8303\uFF1A <ul><li>\u952E\u4E0D\u80FD\u542B\u6709\\0 (\u7A7A\u5B57\u7B26)\u3002\u8FD9\u4E2A\u5B57\u7B26\u7528\u6765\u8868\u793A\u952E\u7684\u7ED3\u5C3E\u3002</li><li>.\u548C$\u6709\u7279\u522B\u7684\u610F\u4E49\uFF0C\u53EA\u6709\u5728\u7279\u5B9A\u73AF\u5883\u4E0B\u624D\u80FD\u4F7F\u7528\u3002</li><li>\u4EE5\u4E0B\u5212\u7EBF&quot;_&quot;\u5F00\u5934\u7684\u952E\u662F\u4FDD\u7559\u7684(\u4E0D\u662F\u4E25\u683C\u8981\u6C42\u7684)\u3002</li></ul></li></ul></blockquote><h3 id="\u6587\u6863" tabindex="-1"><a class="header-anchor" href="#\u6587\u6863" aria-hidden="true">#</a> \u6587\u6863</h3><ul><li><p><strong>\u6587\u6863\u57FA\u672CCRUD</strong></p></li><li><p>\u6DFB\u52A0\u6587\u6863</p><ul><li><p>\u6587\u6863(document)\u7684\u6570\u636E\u7ED3\u6784\u548C<code>JSON</code>\u57FA\u672C\u4E00\u6837</p></li><li><p><code>db.\u96C6\u5408\u540D.\u65B9\u6CD5</code></p></li><li><p>\u4F7F\u7528<code>insertOne()</code>\u5411\u96C6\u5408\u63D2\u5165\u6587\u6863</p><ul><li><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>\u96C6\u5408\u540D<span class="token punctuation">.</span>insertOne<span class="token punctuation">(</span>{\u952E:\u503C<span class="token punctuation">,</span> \u952E:\u503C<span class="token punctuation">,</span> \u952E:\u503C}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li></ul></li><li><p><code>insertMany([{\u952E:\u503C, \u952E:\u503C}, {\u952E:\u503C}, {\u952E:\u503C}])</code>\uFF1A\u6279\u91CF\u63D2\u5165</p></li></ul></li></ul><p>\u4E00\u5B9A\u8981\u8BB0\u5F97\u6DFB\u52A0\u4E3B\u952E\uFF1A<code>_id</code>\uFF0C\u5982\u679C\u5FD8\u8BB0\u6DFB\u52A0\u4F1A\u81EA\u52A8\u751F\u6210</p><ul><li><p>\u67E5\u8BE2\u6587\u6863</p><ul><li><code>find(&lt;query&gt;, [projection])</code>\uFF1A\u67E5\u8BE2\u6587\u6863</li><li><code>findOne()</code>\uFF1A\u8FD4\u56DE\u7B2C\u4E00\u6761\u6570\u636E</li><li><code>find({\u6761\u4EF6}, {\u952E:1})</code>\uFF1A<strong>\u6295\u5F71\u67E5\u8BE2</strong>\uFF0C\u67E5\u8BE2\u7ED3\u679C\u8FD4\u56DE\u90E8\u5206\u5B57\u6BB5 <ul><li><strong>\u53EA\u663E\u793A\u952E</strong>\uFF0C1\u8868\u793A\u771F\uFF0C\u53EA\u663E\u793A\u3002\u9ED8\u8BA4<code>_id</code>\u4F1A\u81EA\u52A8\u663E\u793A\uFF0C\u5982\u679C\u60F3\u9690\u85CF\u9700<code>_id: 0</code></li></ul></li></ul></li><li><p>\u6355\u83B7\u9519\u8BEF</p><ul><li><p>\u5728\u8FDB\u884C\u63D2\u5165\u6587\u6863\u7684\u65F6\u5019\uFF0C\u5982\u679C\u51FA\u9519\u5C06\u7EC8\u6B62\u63D2\u5165\uFF0C\u5DF2\u7ECF\u63D2\u5165\u6210\u529F\u7684\u4E0D\u4F1A\u56DE\u6EDA\uFF0C\u9700\u8981\u4F7F\u7528<code>try catch</code></p><ul><li><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>try<span class="token punctuation">{</span>
	\u63D2\u5165\u8BED\u53E5
<span class="token punctuation">}</span>catch(e)<span class="token punctuation">{</span>
	print(e);
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li><li><p><strong>\u6587\u6863\u66F4\u65B0</strong>\uFF1A<code>updateone(query, update, options)</code></p><ul><li><p><strong>\u8986\u76D6\u4FEE\u6539</strong>\uFF1A\u5176\u4ED6\u6570\u636E\u5168\u90E8\u6CA1\u6709\uFF0C<strong>\u53EA\u5269\u4E0Bid\u548Cname</strong></p></li><li><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{_id:<span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> {name:<span class="token string">&quot;myname&quot;</span>}}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p><strong>\u5C40\u90E8\u4FEE\u6539</strong>\uFF1A<code>$set</code>\uFF0C\u53EA\u4FEE\u6539name\uFF0C\u5176\u4ED6\u4E0D\u7BA1</p></li><li><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{_id:<span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> {$<span class="token keyword">set</span>:{name:<span class="token string">&quot;myname&quot;</span>}}}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p><strong>\u6279\u91CF\u4FEE\u6539</strong>\uFF1A\u4F7F\u7528<code>updateMany</code>\u6216\u4F7F\u7528\u53EF\u9009\u53C2\u6570<code>{multi:true} </code></p></li><li><p><strong>\u5217\u503C\u589E\u957F\u7684\u4FEE\u6539</strong>\uFF1A<code>$inc</code>\u6BCF\u6B21\u589E\u52A01\uFF08\u5BF93\u53F7\u6570\u636E\u7684\u70B9\u8D5E\u6570\uFF0C\u6BCF\u6B21\u9012\u589E1 \uFF09</p></li><li><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span><span class="token keyword">comment</span><span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{_id:<span class="token string">&quot;3&quot;</span>}<span class="token punctuation">,</span>{$inc:{likenum:<span class="token number">1</span>}}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li></ul></li><li><p><code>deleteOne(\u6761\u4EF6)</code>\uFF1A\u5220\u9664\u6587\u6863</p></li><li><p><code>deleteMany</code>\uFF0C\u540C\u4E0A</p></li></ul></li><li><p><strong>\u6587\u6863\u7684\u66F4\u591A\u67E5\u8BE2</strong></p><ul><li><code>count(query, options)</code>\uFF1A\u7EDF\u8BA1\u67E5\u8BE2\uFF0C\u8FD4\u56DE\u6570\u5B57</li><li><code>find().skip(number).limit(number)</code>\uFF1A\u5206\u9875\u67E5\u8BE2\uFF0C\u4F7F\u7528ship\u8DF3\u8FC7\u6307\u5B9A\u6570\u91CF\u7684\u6570\u636E\uFF0C\u901A\u8FC7limit\u8BFB\u53D6\u6307\u5B9A\u6570\u91CF\u7684\u6570\u636E</li></ul></li></ul><p><strong>\u610F\u601D\u662F\uFF0C\u8DF3\u8FC7\u7B2C\u4E00\u6761\u6570\u636E\uFF0C\u67E5\u8BE2\u540E\u9762\u4E24\u6761\u6570\u636E</strong></p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>b<span class="token punctuation">.</span>stu<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>{class: <span class="token string">&#39;610&#39;</span>}<span class="token punctuation">)</span>
db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>\u64CD\u4F5C\u7B26\u6280\u5DE7\uFF1A\u5927<code>g</code>great\uFF0C\u5C0F<code>l</code>less\uFF0C\u4E8E<code>t</code>than\uFF0C\u7B49\u4E8E<code>e</code>equal\uFF0C\u4E0D<code>n</code>not</p></blockquote><ul><li><p>\u6392\u5E8F</p><ul><li><code>find().sort(key:1)</code>\uFF1A\u6392\u5E8F\u67E5\u8BE2\uFF0C1\u548C-1\u4EE3\u8868\u5347\u5E8F\u548C\u964D\u5E8F\uFF0C\u53EF\u4EE5\u548C<code>sort&gt;ship&gt;limit</code>\u4E00\u8D77\u8FDE\u7528\uFF0C\u6267\u884C\u987A\u5E8F\u3002</li><li><code>find({\u5B57\u6BB5:/\u6B63\u5219\u8868\u8FBE\u5F0F/}) </code>\uFF1A\u6B63\u5219\u8868\u8FBE\u5F0F\u641C\u7D22</li><li><code>find({\u5B57\u6BB5\u540D1: {$\u64CD\u4F5C\u7B26: \u503C}})</code>\uFF1A\u6BD4\u8F83\u67E5\u8BE2 <ul><li>\u64CD\u4F5C\u7B26\uFF1Agt\u3001lt\u3001gte\u3001lte\u3001ne\uFF08\u5927\u4E8E\u3001\u5C0F\u4E8E\u3001\u5927\u4E8E\u7B49\u4E8E\u3001\u5C0F\u4E8E\u7B49\u4E8E\u3001\u4E0D\u7B49\u4E8E\uFF09</li><li>\u5B57\u6BB51\u5927\u4E8E\u5B57\u6BB52\u5C31\u662F<code>\u5B57\u6BB51 : {$gt: \u5B57\u6BB52}</code></li></ul></li></ul></li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{_id: {$gt: <span class="token number">2</span>}}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><blockquote><p>tips</p><p>\u67E5\u8BE2\u8BC4\u8BBA\u96C6\u5408\u4E2Dlikenum\u5927\u4E8E\u7B49\u4E8E700 \u5E76\u4E14\u5C0F\u4E8E2000\u7684\u6587\u6863</p><ol><li>\u521D\u59CB</li></ol><p><code>find({})</code></p><ol start="2"><li>\u5F53\u6709\u591A\u4E2A\u6761\u4EF6\u5224\u65AD\u65F6\uFF0C\u7B2C\u4E00\u6B65\u5148\u5224\u65AD\u662F<strong>\u4E0E</strong>\u8FD8\u662F<strong>\u6216</strong>\u3002\u5199\u4E0B<strong>\u64CD\u4F5C\u7B26</strong>\u548C<strong>\u65B9\u62EC\u53F7</strong></li></ol><p><code>find({$and: []})</code></p><ol start="3"><li>\u5728\u65B9\u62EC\u53F7\u91CC\u9762\u6DFB\u52A0\u5224\u65AD\u8BED\u53E5\u3002\u6839\u636E\u6761\u4EF6\u6DFB\u52A0\u9002\u91CF\u7684<strong>\u82B1\u62EC\u53F7</strong>\u7528\u9017\u53F7\u9694\u5F00</li></ol><p><code>find({$and: [{},{}]})</code></p><p><code>find({$and: [{$gt: 700},{$lt: 2000}]})</code></p></blockquote><ul><li><p><strong>\u5305\u542B\u67E5\u8BE2</strong>\uFF1A<code>find(\u5B57\u6BB5\u540D1 : {$\u64CD\u4F5C\u7B26: [ { },{ },{ } ]})</code></p><ul><li><p>\u64CD\u4F5C\u7B26\uFF1Ain\u548Cnin\uFF08\u5305\u542B\u548C\u4E0D\u5305\u542B\uFF09\uFF0Cand\u3001or\uFF08\u4E0E\u6216\uFF09</p><ul><li><p>\u67E5\u8BE2\u8BC4\u8BBA\u96C6\u5408\u4E2Dlikenum\u5927\u4E8E\u7B49\u4E8E700 \u5E76\u4E14\u5C0F\u4E8E2000\u7684\u6587\u6863\uFF1A</p></li><li><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span><span class="token keyword">comment</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>{$<span class="token operator">and</span>:<span class="token punctuation">[</span>{likenum:{$gte:<span class="token number">700</span>}}<span class="token punctuation">,</span>{likenum:{$lt:<span class="token number">2000</span>}}<span class="token punctuation">]</span>}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p>\u67E5\u8BE2\u8BC4\u8BBA\u96C6\u5408\u4E2Duserid\u4E3A1003\uFF0C\u6216\u8005\u70B9\u8D5E\u6570\u5C0F\u4E8E1000\u7684\u6587\u6863\u8BB0\u5F55</p></li><li><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span><span class="token keyword">comment</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>{$<span class="token operator">or</span>:<span class="token punctuation">[</span> {userid:<span class="token string">&quot;1003&quot;</span>} <span class="token punctuation">,</span>{likenum:{$lt:<span class="token number">1000</span>} }<span class="token punctuation">]</span>}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li></ul></li></ul></li></ul><h3 id="\u5C0F\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u5C0F\u7ED3" aria-hidden="true">#</a> \u5C0F\u7ED3</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u9009\u62E9\u5207\u6362\u6570\u636E\u5E93\uFF1Ause articledb
\u63D2\u5165\u6570\u636E\uFF1Adb.comment.insert({bson\u6570\u636E})
\u67E5\u8BE2\u6240\u6709\u6570\u636E\uFF1Adb.comment.find();
\u6761\u4EF6\u67E5\u8BE2\u6570\u636E\uFF1Adb.comment.find({\u6761\u4EF6})
\u67E5\u8BE2\u7B26\u5408\u6761\u4EF6\u7684\u7B2C\u4E00\u6761\u8BB0\u5F55\uFF1Adb.comment.findOne({\u6761\u4EF6})
\u67E5\u8BE2\u7B26\u5408\u6761\u4EF6\u7684\u524D\u51E0\u6761\u8BB0\u5F55\uFF1Adb.comment.find({\u6761\u4EF6}).limit(\u6761\u6570)
\u67E5\u8BE2\u7B26\u5408\u6761\u4EF6\u7684\u8DF3\u8FC7\u7684\u8BB0\u5F55\uFF1Adb.comment.find({\u6761\u4EF6}).skip(\u6761\u6570)
\u4FEE\u6539\u6570\u636E\uFF1Adb.comment.update({\u6761\u4EF6},{\u4FEE\u6539\u540E\u7684\u6570\u636E}) \u6216db.comment.update({\u6761\u4EF6},{$set:{\u8981\u4FEE\u6539\u90E8\u5206\u7684\u5B57\u6BB5:\u6570\u636E})
\u4FEE\u6539\u6570\u636E\u5E76\u81EA\u589E\u67D0\u5B57\u6BB5\u503C\uFF1Adb.comment.update({\u6761\u4EF6},{$inc:{\u81EA\u589E\u7684\u5B57\u6BB5:\u6B65\u8FDB\u503C}})
\u5220\u9664\u6570\u636E\uFF1Adb.comment.remove({\u6761\u4EF6})
\u7EDF\u8BA1\u67E5\u8BE2\uFF1Adb.comment.count({\u6761\u4EF6})
\u6A21\u7CCA\u67E5\u8BE2\uFF1Adb.comment.find({\u5B57\u6BB5\u540D:/\u6B63\u5219\u8868\u8FBE\u5F0F/})
\u6761\u4EF6\u6BD4\u8F83\u8FD0\u7B97\uFF1Adb.comment.find({\u5B57\u6BB5\u540D:{$gt:\u503C}})
\u5305\u542B\u67E5\u8BE2\uFF1Adb.comment.find({\u5B57\u6BB5\u540D:{$in:[\u503C1\uFF0C\u503C2]}})\u6216db.comment.find({\u5B57\u6BB5\u540D:{$nin:[\u503C1\uFF0C\u503C2]}})
\u6761\u4EF6\u8FDE\u63A5\u67E5\u8BE2\uFF1Adb.comment.find({$and:[{\u6761\u4EF61},{\u6761\u4EF62}]})\u6216db.comment.find({$or:[{\u6761\u4EF61},{\u6761\u4EF62}]})
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="\u4E8C\u3001\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001\u7D22\u5F15" aria-hidden="true">#</a> \u4E8C\u3001\u7D22\u5F15</h2><ul><li><p>\u5355\u5B57\u6BB5\u7D22\u5F15</p><ul><li>\u6839\u636E\u4E00\u4E2A\u5B57\u6BB5\u4E0A<strong>\u8FDB\u884C\u6392\u5E8F</strong>\u7684\u7D22\u5F15\uFF0C\u548C\u6570\u636E\u7ED3\u6784\u4E2D\u7684<strong>\u4E8C\u5206\u63A2\u6D4B\u6CD5</strong>\u5DEE\u4E0D\u591A</li></ul></li><li><p>\u590D\u5408\u7D22\u5F15</p><ul><li>\u7531\u591A\u4E2A\u5B57\u6BB5\u7EC4\u6210\u7684\u6392\u5E8F</li></ul></li><li><p>\u5730\u7406\u7A7A\u95F4\u7D22\u5F15\u3001\u6587\u672C\u7D22\u5F15\u3001\u54C8\u5E0C\u7D22\u5F15</p></li><li><p>\u7D22\u5F15\u7684\u7BA1\u7406\u64CD\u4F5C</p><ul><li><p><code>db.\u96C6\u5408\u540D.getIndexes()</code>\uFF1A\u7D22\u5F15\u67E5\u770B</p><ul><li><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">//\u8FD4\u56DE\u4E00\u4E2A\u96C6\u5408\u4E2D\u7684\u6240\u6709\u7D22\u5F15\u7684\u6570\u7EC4 &quot;_id&quot;\u662F\u9ED8\u8BA4\u521B\u5EFA\u7D22\u5F15</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>class<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
	{
		<span class="token string">&quot;v&quot;</span> : <span class="token number">2</span><span class="token punctuation">,</span>            <span class="token comment">//\u7248\u672C\u53F7</span>
		<span class="token string">&quot;key&quot;</span> : {           <span class="token comment">//\u7D22\u5F15\u7684key  1\u662F\u5347\u5E8F</span>
			<span class="token string">&quot;_id&quot;</span> : <span class="token number">1</span>
		}<span class="token punctuation">,</span>
		<span class="token string">&quot;name&quot;</span> : <span class="token string">&quot;_id_&quot;</span><span class="token punctuation">,</span>    <span class="token comment">//\u7D22\u5F15\u540D\u79F0</span>
		<span class="token string">&quot;ns&quot;</span> : <span class="token string">&quot;Rainbow.class&quot;</span>  <span class="token comment">//\u7D22\u5F15\u6240\u5728\u7684\u8868\u7684\u7EDD\u5BF9\u8DEF\u5F84</span>
	}
<span class="token punctuation">]</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul></li></ul><blockquote><p>\u590D\u5408\u7D22\u5F15-&gt;\u5982\u679C\u67E5\u8BE22\u4E2A\u5219\u4F1A\u547D\u4E2D\u7D22\u5F15\uFF0C\u5355\u72EC\u67E5\u8BE2\u7B2C\u4E00\u4E2A(userid)\u4E5F\u4F1A\u547D\u4E2D\uFF0C\u4F46\u662F\u5982\u679C\u662F**\u5355\u72EC\u67E5\u8BE2\u7B2C\u4E8C\u4E2A(nickname)**\u5C31\u4E0D\u4F1A\u547D\u4E2D\u7D22\u5F15\u3002</p></blockquote><ul><li><p><code>createIndex(keys, options)</code>\uFF1A\u521B\u5EFA\u7D22\u5F15</p></li><li><p><code>createIndex({userid:1, nickname:-1}, options)</code>\uFF1A\u590D\u5408\u7D22\u5F15</p><ul><li>\u6839\u636E<code>userid</code>\u8FDB\u884C\u5347\u5E8F\uFF0C\u7136\u540E\u5728\u6839\u636E<code>nickname</code>\u8FDB\u884C\u964D\u5E8F</li></ul></li></ul><p>options\uFF1A\u552F\u4E00\u7D22\u5F15<code>{&quot;unique&quot;: true}</code></p><ul><li><p><code>dropIndex(&quot;\u7D22\u5F15\u540D\u79F0&quot;)</code>\uFF1A\u5220\u9664\u7D22\u5F15</p><ul><li><code>dropIndex({userid: 1})</code></li></ul></li><li><p><code>dropIndexes()</code>\uFF1A\u5220\u9664\u5168\u90E8\u7D22\u5F15</p></li></ul></li><li><p><strong>\u7D22\u5F15\u7684\u4F7F\u7528</strong></p><ul><li><code>find(query, options).explan(&quot;executionStats&quot;)</code>\uFF1A\u5206\u6790\u67E5\u8BE2\u6027\u80FD <ul><li><code>&quot;stage&quot; : &quot;COLLSCAN&quot;</code> \uFF0C\u8868\u793A\u5168\u96C6\u5408\u626B\u63CF\u8FD8\u6CA1\u7528\u7D22\u5F15</li><li><code>&quot;stage&quot; : &quot;IXSCAN&quot;</code>\uFF0C\u57FA\u4E8E\u7D22\u5F15\u7684\u626B\u63CF\u7528\u4E0A\u4E86\u7D22\u5F15</li></ul></li><li>\u6DB5\u76D6\u7684\u67E5\u8BE2\uFF1A\u4F8B\u5982\u7D22\u5F15\u5B57\u6BB5\u662Fid\uFF0C\u7136\u540E\u6211\u5C31\u662F\u67E5id\u90A3\u4E48\u4ED6\u5C31\u76F4\u63A5\u4ECE\u7D22\u5F15\u4E2D\u8FD4\u56DE\u7ED3\u679C\uFF0C\u800C\u4E0D\u626B\u63CF\u4EFB\u4F55\u6587\u6863\u6216\u5C06\u6587\u6863\u5E26\u5165\u5185\u5B58\u3002 \u8FD9\u4E9B\u8986\u76D6\u7684\u67E5\u8BE2\u53EF\u4EE5 \u975E\u5E38\u6709\u6548\u3002</li></ul></li></ul><h2 id="\u4E09\u3001\u8D26\u6237\u6743\u9650" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u8D26\u6237\u6743\u9650" aria-hidden="true">#</a> \u4E09\u3001\u8D26\u6237\u6743\u9650</h2><blockquote><p><strong>roles\u89D2\u8272\uFF1A</strong></p><ol><li><p>\u6570\u636E\u5E93\u7528\u6237\u89D2\u8272\uFF1Aread\u3001readWrite;</p></li><li><p>\u6570\u636E\u5E93\u7BA1\u7406\u89D2\u8272\uFF1AdbAdmin\u3001<strong>dbOwner</strong>\u3001userAdmin\uFF1B</p></li><li><p>\u96C6\u7FA4\u7BA1\u7406\u89D2\u8272\uFF1AclusterAdmin\u3001clusterManager\u3001clusterMonitor\u3001hostManager\uFF1B</p></li><li><p>\u5907\u4EFD\u6062\u590D\u89D2\u8272\uFF1Abackup\u3001restore\uFF1B</p></li><li><p>\u6240\u6709\u6570\u636E\u5E93\u89D2\u8272\uFF1AreadAnyDatabase\u3001readWriteAnyDatabase\u3001userAdminAnyDatabase\u3001dbAdminAnyDatabase</p></li><li><p>\u8D85\u7EA7\u7528\u6237\u89D2\u8272\uFF1A**root **</p></li></ol><p>Read\uFF1A\u5141\u8BB8\u7528\u6237\u8BFB\u53D6\u6307\u5B9A\u6570\u636E\u5E93 readWrite\uFF1A\u5141\u8BB8\u7528\u6237\u8BFB\u5199\u6307\u5B9A\u6570\u636E\u5E93 <strong>dbOwner</strong>\uFF1A\u5141\u8BB8\u7528\u6237\u5728\u6307\u5B9A\u6570\u636E\u5E93\u4E2D\u6267\u884C\u5168\u90E8\u64CD\u4F5C dbAdmin\uFF1A\u5141\u8BB8\u7528\u6237\u5728\u6307\u5B9A\u6570\u636E\u5E93\u4E2D\u6267\u884C\u7BA1\u7406\u51FD\u6570\uFF0C\u5982\u7D22\u5F15\u521B\u5EFA\u3001\u5220\u9664\uFF0C\u67E5\u770B\u7EDF\u8BA1\u6216\u8BBF\u95EEsystem.profile userAdmin\uFF1A\u5141\u8BB8\u7528\u6237\u5411system.users\u96C6\u5408\u5199\u5165\uFF0C\u53EF\u4EE5\u627E\u6307\u5B9A\u6570\u636E\u5E93\u91CC\u521B\u5EFA\u3001\u5220\u9664\u548C\u7BA1\u7406\u7528\u6237 clusterAdmin\uFF1A\u53EA\u5728admin\u6570\u636E\u5E93\u4E2D\u53EF\u7528\uFF0C\u8D4B\u4E88\u7528\u6237\u6240\u6709\u5206\u7247\u548C\u590D\u5236\u96C6\u76F8\u5173\u51FD\u6570\u7684\u7BA1\u7406\u6743\u9650\u3002 readAnyDatabase\uFF1A\u53EA\u5728admin\u6570\u636E\u5E93\u4E2D\u53EF\u7528\uFF0C\u8D4B\u4E88\u7528\u6237\u6240\u6709\u6570\u636E\u5E93\u7684\u8BFB\u6743\u9650 readWriteAnyDatabase\uFF1A\u53EA\u5728admin\u6570\u636E\u5E93\u4E2D\u53EF\u7528\uFF0C\u8D4B\u4E88\u7528\u6237\u6240\u6709\u6570\u636E\u5E93\u7684\u8BFB\u5199\u6743\u9650 userAdminAnyDatabase\uFF1A\u53EA\u5728admin\u6570\u636E\u5E93\u4E2D\u53EF\u7528\uFF0C\u8D4B\u4E88\u7528\u6237\u6240\u6709\u6570\u636E\u5E93\u7684userAdmin\u6743\u9650 dbAdminAnyDatabase\uFF1A\u53EA\u5728admin\u6570\u636E\u5E93\u4E2D\u53EF\u7528\uFF0C\u8D4B\u4E88\u7528\u6237\u6240\u6709\u6570\u636E\u5E93\u7684dbAdmin\u6743\u9650\u3002 root\uFF1A\u53EA\u5728admin\u6570\u636E\u5E93\u4E2D\u53EF\u7528\u3002\u8D85\u7EA7\u8D26\u53F7\uFF0C\u8D85\u7EA7\u6743\u9650</p></blockquote><p>\u521B\u5EFA\u8D85\u7EA7\u7BA1\u7406\u5458</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">use</span> admin
db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span>{
    <span class="token keyword">user</span>: <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
    pwd: <span class="token string">&#39;123456&#39;</span><span class="token punctuation">,</span>
    roles: <span class="token punctuation">[</span>{role: <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span> db:<span class="token string">&#39;admin&#39;</span>}<span class="token punctuation">]</span>
}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u8FDB\u5165\u914D\u7F6E\u6587\u4EF6\u6DFB\u52A0\u70B9\u4E1C\u897F</p><p><code>\\MongoDB\\Server\\4.4\\bin\\mongod.cfg</code></p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>security:
  <span class="token keyword">authorization</span>: enabled
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u767B\u9646\u8D26\u6237</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>mongo admin <span class="token operator">-</span>u \u7528\u6237\u540D <span class="token operator">-</span>p \u5BC6\u7801
mongo IP\u5730\u5740:<span class="token number">27017</span><span class="token operator">/</span>test <span class="token operator">-</span>u \u7528\u6237\u540D <span class="token operator">-</span>p \u5BC6\u7801
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u8FDE\u63A5stu\u5E93\uFF0C\u7136\u540E\u767B\u9646</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>mongo stu
db<span class="token punctuation">.</span>auto<span class="token punctuation">(</span><span class="token string">&quot;\u7528\u6237\u540D&quot;</span>: <span class="token string">&quot;\u5BC6\u7801&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u67E5\u770B\u7528\u6237\uFF1A<code>show users</code></p><p>\u5220\u9664\u7528\u6237\uFF1A<code>db.dropUser()</code></p><h2 id="\u56DB\u3001\u805A\u5408\u7BA1\u9053" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001\u805A\u5408\u7BA1\u9053" aria-hidden="true">#</a> \u56DB\u3001\u805A\u5408\u7BA1\u9053</h2><p><code>$project</code>\uFF1Amysql\u4E2D\u7684select</p><p>\u8BBE\u7F6E\u522B\u540D\u3001\u52A0\u6CD5\uFF08<strong>$add</strong>\uFF09\u3001\u51CF\u6CD5\uFF08<strong>$subtract</strong>\uFF09\u3001\u4E58\u6CD5\uFF08<strong>$multipy</strong>\uFF09\u3001\u9664\u6CD5\uFF08<strong>$divide</strong>\uFF09\u3001\u6C42\u6A21\uFF08<strong>$mod</strong>\uFF09</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">// \u91CD\u547D\u540D\u5B57\u6BB5class</span>
<span class="token comment">// \u901A\u8FC7 &quot;$class&quot; \u6765\u8868\u793A\u64CD\u4F5C\u7684\u5B57\u6BB5</span>
db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span>
  {
    $project: {_id:<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> class: <span class="token number">1</span><span class="token punctuation">,</span> myclass: <span class="token string">&quot;$class&quot;</span>}
  }
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>$match</code>\uFF1A\u6761\u4EF6\u5339\u914D\u3002\u53EA\u6EE1\u8DB3\u6761\u4EF6\u7684\u6587\u6863\u4ECE\u80FD\u8FDB\u5165\u4E0B\u4E00\u9636\u6BB5</p><p>\u663E\u793Aid\u5927\u4E8E2\u7684</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span>
  {
    $project: {_id:<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> class: <span class="token number">1</span><span class="token punctuation">,</span> myclass: <span class="token string">&quot;$class&quot;</span>}
  }<span class="token punctuation">,</span>
  {
    $<span class="token keyword">match</span>: {_id: {$gt: <span class="token number">2</span>}}
  }
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><code>$limit</code>\uFF1A\u9650\u5236\u7ED3\u679C\u6570\u91CF</p><p><code>$skip</code>\uFF1A\u8DF3\u8FC7\u6587\u6863\u6570\u91CF</p><p><code>$sort</code>\uFF1A\u6761\u4EF6\u6392\u5E8F</p><p><code>$group</code>\uFF1A\u6761\u4EF6\u7EC4\u5408\u7ED3\u679C</p><p>\u7EDF\u8BA1class\u7C7B\u522B\uFF0C\u6BCF\u4E2A\u7C7B\u522B\u7684\u6570\u91CF</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span>
  {
    $<span class="token keyword">group</span>: {_id: <span class="token string">&quot;$class&quot;</span><span class="token punctuation">,</span> count: {$sum: <span class="token number">1</span>}}
  }
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>$lookup</code>\uFF1A\u5F15\u5165\u5176\u4ED6\u96C6\u5408\u7684\u6570\u636E</p>`,51);function t(l,p){return e}var i=s(a,[["render",t]]);export{i as default};
